## 脚本说明

一个简单的批处理脚本，主要是为了方便一键启动 Chrome 浏览器和启动指定 Anaconda 环境（可选）下的 mitmdump 附带 Python script 对网络请求进行中间人处理。

注意：脚本会自动切换到 Python 处理脚本的所在目录下，所以在处理脚本里使用相对路径是可以的。

> 每次都按按按按按，我都累了🐎

**浏览器方面**可以选择是否使用无痕模式、是否自动开启控制台、是否自动打开指定网址（见[缺陷2](#缺陷)）。

**Anaconda 环境方面**可以自由选择要激活的环境，或者不使用 Anaconda。

**mitmdump 方面**可以选择监听的地址、端口、处理脚本路径，以及其它自己想添加的指令。

> 必须要有处理脚本，因为出发目的就不是为了抓包，单纯要抓包的话，mitmdump 不够清晰明了。

## 运行要求

- Windows 系统。
- Chrome 浏览器。
- Python 或指定的 Anaconda 环境中需要安装 mitmdump。
- 自己写好的 mitmdump 的网络请求 Python 处理脚本。

## 配置说明

可以在 config.ini 中进行配置。因为 Windows 系统原因，本文件夹内**所有文件均使用的 ASCII 编码**！

> 建议使用 Notepad2、Notepad++ 或者记事本编辑文件，其它 IDE 编辑时可能会将中文显示为乱码。

其它的在 config.ini 文件里都说得很清楚了。

![图片](https://tva1.sinaimg.cn/large/d3dde9a5ly1gpkd1n86b4j20nm0pu0u6.jpg)

## 使用说明

配置完文件后，双击 `一键启动浏览器与脚本.bat` 即可。这将会自动打开 mitmdump，**等待 5s 后**（见[缺陷1](#缺陷)），自动按配置打开 Chrome 浏览器。

`启动抓包脚本.bat` 则是单纯地按配置启动附带 Python 处理脚本的 mitmdump。如果使用其它非 Chrome 浏览器的话，就可以仅使用这个。目前因为个人需求，没有看其它浏览器的启动参数。

还可以直接将脚本文件用鼠标拖到 `启动抓包脚本.bat` 文件上直接运行指定的处理脚本。其它的配置仍然使用的 config.ini 里的信息。

## 缺陷

1. 无法准确地检测 mitmdump 是否启动完成。因为要测试的话需要建立 TCP 链接来查验指定端口，有那时间不如等 5s 就好了。

2. 自动打开网址与自动打开控制台一起使用的时候，由于打开网址的速度比打开控制台的速度快，会导致**控制台不会记录到刚开始的一些数据**！这一点值得注意。需要完整的数据的话，就需要手动打开网址了。

> 翻看了 Chromium 的启动参数文档，没有找到相关的参数可以调整这个打开的时机的。
